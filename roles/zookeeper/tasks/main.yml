
- name: create zookeeper group
  group:
    name: zookeeper
    state: present

- name: create zookeeper user
  user: 
    name: "{{ storm }}"
    password:  " {{ storm | password_hash('sha512') }}"
    group: sudo
    state: present

- name: download zookeeper tar
  get_url:
    url: https://downloads.apache.org/zookeeper/zookeeper-3.6.0/apache-zookeeper-3.6.0-bin.tar.gz
    dest: /root/zookeeper.tar.gz
    owner: "{{ storm }}"



- name: Untar zookeeper 
  unarchive:
    src: /root/zookeeper.tar.gz
    dest: /etc/
    owner: "{{ storm }}"
    remote_src: yes
  

- name: configure and change conf file
  copy:
    src: zoo.cfg
    dest: /etc/apache-zookeeper-3.6.0-bin/conf/zoo.cfg
    owner: "{{ storm }}"
    group: zookeeper



- name: Add service files
  copy:
    src: nimbus 
    dest: /etc/init/nimbus.conf

- name: Add  for ui file
  copy:
    src:  ui
    dest: /etc/init/ui.conf

- name: Copy ZK service file
  copy:
    src: zookeeper.service
    dest: /etc/systemd/system/zookeeper.service
    

- name: start all services
  service:
    name: "{{ item }}"
    state: started
  with_items:
    - zookeeper
    - nimbus
    - ui

    